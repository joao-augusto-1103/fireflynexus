rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Regra para coleção de usuários (global)
    match /usuarios/{userId} {
      // Qualquer usuário autenticado pode ler/editar usuários
      allow read, write: if request.auth != null;
    }
    
    // Regras para dados compartilhados (comportamento original)
    match /clientes/{document} {
      allow read, write: if request.auth != null;
    }
    
    match /ordens_servico/{document} {
      allow read, write: if request.auth != null;
    }
    
    match /ordens_venda/{document} {
      allow read, write: if request.auth != null;
    }
    
    match /produtos/{document} {
      allow read, write: if request.auth != null;
    }
    
    match /categorias/{document} {
      allow read, write: if request.auth != null;
    }
    
    match /movimentacoes/{document} {
      allow read, write: if request.auth != null;
    }
    
    match /financeiro/{document} {
      allow read, write: if request.auth != null;
    }
    
    // Regras para configurações (globais)
    match /configuracoes/{document} {
      allow read, write: if request.auth != null;
    }
    
    match /configuracoes_loja/{document} {
      allow read, write: if request.auth != null;
    }
    
    // Regras para dados de teste
    match /test_data/{document} {
      allow read, write: if request.auth != null;
    }
    
    // Negar acesso a qualquer outro documento
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
